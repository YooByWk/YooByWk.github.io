# 2024.02.19
블록체인

### 블록체인 개요 :
- 비트코인 : 정부 거대 기업으로부터 개인의 권리와 자산을 지키기 위한 운동. 사토시 나카모토가 발명
- 세계 최초의 탈중앙형 화폐
- 2009 1월 3일 사토시 나카모토의 첫 채굴이 일어나며 비트코인 네트워크 가동 시작
- 비트코인 최초 블록 에는 영국 정부의 구제금융 발표 뉴스의 제목 기록

### 블록체인 2.0 
- 업계 최초 ICO (Initial Coin Offering) 를 통해 개발비 모금
- 2015 이더리움 네트워크 시작
- 탈 중앙화된 컴퓨팅 인프라. 월드 컴퓨터라고도 불림
- 블록체인에 스마트 컨트랙드 도입. DAO (Decentralized Autonomous Organization) 자기주권신원증명 탈중앙형 금융등의 가능성을 보여주고 Web3.0의 기반을 마련했다는 평가

### 블록체인 정의 :
P2P (Peer to Peer) 네트워크를 통해 관리되는 분산 데이터 베이스의 한형태로 블록체인 노드에 디지털 서명된 거래 정보를 보관하는 **분산 원장 기술**


### 동작 원리 :
1. 누군가 트랜잭션을 만들어 요청
2. 트랜잭션을 요청 받은 노드는 트랜잭션의 유효성 검증 
3. 유효한 트랜잭션이 블록체인의 P2P 네트워크에 전파
4. 블록 생성자는 블록 생성 규칙 준수하며, 검증된 트랜잭션을 포함하는 새 블록을 생성한다.
5. 생성된 새로운 블록이 P2P 네트워크엑 전파
6. 기존 블록에 새로운 블록이 연결되며 트랜잭션이 처리된다,

## 블록체인의 암호학
1. 공개키 암호화
-  *공개키 암호화 == 비대칭 암호화*
 -  계산하기는 쉽지만 그 역을 계산하기 어려운 특수한 함수를 바탕으로 생성된 고유한 키를 사용하여 정보를 보호하는 방법
  - 비트코인 및 이더리움에서는 이산 로그 문제를 이용하는 타원곡선 암호화를 활용

- 개인키(k)
  - 1 ~ 2^256 사이의 무작위로 선택한 숫자
  - 개인키 생성 프로세스는 오프라인 프로세스 
  - 대부분의 프로그래밍 언어에 있는 rand 함수 같은 암호학적으로 안전하지 않는 난수 생성기 사용 금지
  - 임의로 생성한 16진수 개인키의 예가 있긴 함

###  해시 함수 
- 임의 크기의 데이터를 고정된 크기 데이터로 매핑하는 함수
- 해시 함수의 입력을 메시지 또는 입력 데이터 결과를 해시(hash) 라 함
- 결과값을 알고 있을 때 입력데이터를 다시 작성하는 것이 불가능한 단방향 함수
- 

## 트랜잭션
- 외부 소유 의해 서명된 메시지 
- 이더리움 네트워크에 전송되고 블록체인에 기록된다.
- 블록체인 상태 변경을 유발하거나 컨트랙트를 실행하는 유일한 방법이다.
- 이더리움은 독자적으로 상태가 변경되지 않는다
- 컨트랙트는 독자적으로 실행되지 않는다.

### Nonce
해당 주소에서 생성한 트랜잭션의 건수
1. 논스값은 0부터 시작하여 트랜잭션을 생성할 순차적으로 증가한다.
   1. 트랜잭션을 순차적으로 처리하기 위해 사용한다.
###  가스
1. 이더에 대한 사용자 지정 환율을 가진 별도의 개념이다.
2. 트랜잭션이 사용할 수 있는 자원의 양을 제어하는데 사용
3. gasLmit : 최대 가스 단위 수를 지정한다.
4. 1  ETH = 10 ^ 18 wei
5. 

### 값과 데이터 (value & data ) 
트랜잭션의 주요 페이로드 
총 네가지 조합 모두 유효하다 
값만 있는 경우 : 이더 지급
데이터만 있는 경우 호출
값과 데이터 모두 있는 경우 : 지급 + 호출
값과 데이터 모두 없느 ㄴ경우 : 트랜잭션은 보내지지만 가스 낭비 

- 새로운 컨트랙트는 트랜잭션 
- - 수신자 주소 0x0 (영주소), 데이터 : 컴파일된 컨트랙트의 바이트 코드
### 디지털 서명 
트랜잭션 정보를 개인키를 사용하여 서명 
- 서명이 담긴 트랜잭션을 함께 받은 누구나 메시지와 공개키만 사용하여 서명을 검증할 수 있다.
- 개인키 소지자에 의해 트랜잭션이 승인되었음을 증명
- 객인키 소지자가 해당 트랜잭션을 승인했음을 부인할 수 없다.
- 서명 후 데이터가 수정되지 않았다.


### 트랜잭션 전파와 기록 
- 보안의 이유로 개인키의 서명과 전송을 분리
- 서명된 트랜잭션은 이더리움 네트워크로 전송할 준비 완료 
- 서명된 트랜잭션을 받은 p2p 네트워크에 연결 노드는 다음 동작 시행 
  - 수신 트랜잭션 서명 검증
  - 유효시 사본 저장 , 자신 이웃 노드에 전파 
- 결과적으로 전 세계 모든 노드로 전파됨 
  - 각 노드의 관점에서는 트랜잭션의 출처 식별 불가
  - 특정 노드는 트랜잭션을 블록에 축사하여 새로운 블록을 만드는 작업 수행 

## 합의 Consensus
1. 작업증명
2. 지분증명

-  분산 시스템에서 상태를 동기화 하기 위해 사용
-  탈중앙화되었지만 결정론적으로 운영하기 위해 각자 지켜야 하는 규칙 
-  누가 생성한 블록이 유효한지 합의하기 위한 프로토콜
-  작업증명, 지분증명이 가장 일반적
-  이더리움은 PoW 에서 PoS로 전환하는 더 머지(the Merge) 업그레이드 완료 /15.09.22
-  

##  Day 1 과제
1.

개인키 - 공개키 - 이더리움 주소 

day1-1.js 개인키를 이볅으로 공개키와 이더리움  주소 생성 

- 입력 개인키는 도서 마스터링 이더리움 4장 예제  주소는 구현 결과 확인 위해 사
- npm install elliiptic
- keccak256 npm install web3-utils

- 비허용 : 
  - Ethers.js, Ethereumjs 등 지갑을 바로 생성하는 외부 라이브러리

2.

    알맞은 값..? 
    Sepolia 유효한 엔드 포인트로 web3 인스턴스 생성 위해 확인
    트랜잭션 직렬화 : rlp 라이브러리
    서명 : 개인키 : 과제 1
    ethereumjs-util 라이브러리로 서명 or keccak256 서명

3. Api 비교
    블록체인 네트워크에 실제 트랜잭션을 제출하기 위해서는 web3.eth의 API인 senTransaction이나 sendSignedTransaction을 이용
    두 API 가 어떻게 다른지 비교하고, 서명과 전송을 분리해야 하는 이유를 서술 (300자 내외, 파일명 day1-essay3.md)

요약 : 

1. 개인키 - 공개키 - 이더리움  
   1. 완성 소스 코드
   2. 입출력 스크린샷
2. 트랜잭션 생성과 서명
   1. 완성 소스 코드
   2. 입출력 스크린샷
3. API 비교
   1. 에세이 파일 

/////////////////////////////////////////